/* Chaos Control v3.1 — styles with muted watercolor bomb and day summary */
:root{
  --bg: #faf9f6;
  --panel: #f3f1ee;
  --text: #1f2937;
  --muted: #6b7280;
  --primary: #137a7f;
  --high: #c44141;
  --medium: #c28b2d;
  --low: #597fa3;
  --card: #ffffff;
  --gold: #f59e0b;
}
.dark:root{
  --bg: #1d1f24;
  --panel: #2a2d33;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --primary: #18a0a6;
  --high: #ff6b6b;
  --medium: #e0aa52;
  --low: #7aa4cf;
  --card: #262a31;
  --gold: #fbbf24;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--text);font:14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica, Arial}
.wrap{max-width:1400px;margin:0 auto;padding:16px;}

.hdr{display:flex;gap:12px;align-items:center;justify-content:space-between;position:relative;margin-bottom:12px;}
.title{font-weight:800;font-size:22px;position:relative;letter-spacing:.3px}
.word-chaos{position:relative;display:inline-block;padding:.1em .2em}
.word-chaos .bomb-bg{
  position:absolute;inset:-6px -12px -8px -12px;z-index:-1;
  /* Muted watercolor bomb asset (SVG) — embedded via background-image inlined in your HTML build */
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='360' height='160' viewBox='0 0 360 160'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop offset='0' stop-color='%23a78bfa' stop-opacity='.22'/%3E%3Cstop offset='1' stop-color='%2334d399' stop-opacity='.20'/%3E%3C/linearGradient%3E%3CradialGradient id='r' cx='0.35' cy='0.35' r='0.75'%3E%3Cstop offset='0' stop-color='%23f472b6' stop-opacity='.18'/%3E%3Cstop offset='1' stop-color='%23f472b6' stop-opacity='0'/%3E%3C/radialGradient%3E%3C/defs%3E%3Cellipse cx='80' cy='60' rx='110' ry='48' fill='url(%23g)'/%3E%3Cellipse cx='210' cy='90' rx='130' ry='52' fill='url(%23r)'/%3E%3Cg transform='translate(220,42) rotate(-8)'%3E%3Ccircle cx='0' cy='36' r='28' fill='%23000' opacity='.12'/%3E%3Crect x='-4' y='-4' width='18' height='10' rx='2' fill='%23000' opacity='.12'/%3E%3Cpath d='M14,1 C28,-4 35,10 40,6' stroke='%23000' opacity='.12' stroke-width='3' fill='none'/%3E%3C/g%3E%3C/svg%3E");
  background-size: cover;
  background-position: center;
  opacity: .9;
  border-radius:18px;
  filter: saturate(85%) blur(.2px);
}

.hdr-tools{display:flex;gap:6px;align-items:center;flex-wrap:wrap}
.search{padding:8px 10px;border-radius:10px;border:1px solid #d1d5db;min-width:260px;background:var(--card);color:var(--text)}
.btn{padding:8px 10px;border-radius:10px;border:1px solid #d1d5db;background:var(--panel);cursor:pointer}
.btn.primary{background:var(--primary);color:#fff;border-color:transparent}
.btn.sm{padding:6px 8px;font-size:12px}
.btn.xs{padding:4px 6px;font-size:11px}

.addbar{position:sticky;top:0;z-index:5;background:linear-gradient(to bottom, var(--panel), transparent);padding:8px;border-radius:12px;margin-bottom:12px;border:1px solid #d1d5db}
.addbar-title{width:100%;padding:10px 12px;border-radius:10px;border:1px solid #d1d5db;background:var(--card);margin-bottom:8px}
.addbar-row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
.w80{width:80px}.w120{width:120px}.w140{width:140px}
.seg{display:inline-flex;gap:8px;align-items:center;background:var(--card);padding:6px 8px;border-radius:999px;border:1px solid #d1d5db}

.layout{display:grid;grid-template-columns:320px 1fr;gap:12px}
.left .panel{background:var(--panel);border-radius:14px;padding:10px;border:1px solid #d1d5db;margin-bottom:12px}
.panel-h{font-weight:700;margin-bottom:8px}
.empty{color:var(--muted)}

.main .week{display:grid;grid-template-columns:repeat(7,1fr);gap:10px}
.daycol{background:var(--panel);border:1px solid #d1d5db;border-radius:14px;overflow:hidden;position:relative}
.daycol.today{outline:2px solid var(--primary)}
.daycol.holiday{background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,0)), var(--panel);}
.holiday-name{font-size:12px;color:var(--muted);padding:4px 8px}

.dayhdr{display:flex;align-items:center;gap:8px;padding:8px;background:var(--card);border-bottom:1px solid #d1d5db}
.dayhdr:hover{filter:brightness(1.03)}
.dname{font-weight:700;width:48px}
.dnum{font-weight:800;font-size:18px}
.cap{flex:1;height:6px;background:#e5e7eb;border-radius:6px;overflow:hidden}
.cap span{display:block;height:6px;background:var(--primary)}

.day-summary{margin:6px 8px;padding:8px;border:1px dashed #d1d5db;border-radius:10px;background:var(--card);font-size:13px;color:var(--text)}
.day-summary.full{background:rgba(245,158,11,.15);border-color:#f59e0b}
.day-ribbon{position:absolute;top:0;left:0;right:0;height:6px;background:linear-gradient(90deg, #fef08a, var(--gold), #fef08a)}

.busy{padding:8px;display:flex;flex-direction:column;gap:8px;position:relative}
.busyitem{border:1px dashed #cbd5e1;border-radius:12px;padding:8px;background:transparent}
.busyitem.done{opacity:.7;background:rgba(148,163,184,.12)}
.busyitem.high .ttl{color:var(--high);font-weight:800}
.busyitem.missed{border-style:dashed;animation:missed 1.2s steps(2,end) infinite}
@keyframes missed{50%{opacity:.85}}

.unsched{border-top:1px dashed #d1d5db;padding:8px}
.unsched-h{font-size:12px;color:var(--muted);margin-bottom:6px}

.taskcard{background:var(--card);border:1px solid #d1d5db;border-radius:12px;padding:8px;margin-bottom:8px}
.taskcard.high .ttl{color:var(--high);font-weight:800}
.taskcard.missed{border-style:dashed}

.row{display:flex;gap:8px;align-items:center;justify-content:space-between}
.row.right{justify-content:flex-end}
.chk{display:inline-flex;gap:6px;align-items:center}
.ttl{font-weight:600}
.meta{display:flex;gap:8px;color:var(--muted);font-size:12px}
.badge{font-size:11px;background:#fee2e2;color:#991b1b;border-radius:999px;padding:2px 6px}
.orig{font-size:12px;color:var(--muted);margin-top:4px}

.toast{position:fixed;right:16px;bottom:16px;background:var(--card);border:1px solid #d1d5db;border-radius:14px;padding:10px 12px;box-shadow:0 10px 30px rgba(0,0,0,.2);display:flex;gap:10px;align-items:center;cursor:pointer;z-index:50}
.toast .star{font-size:20px}
.toast .msg{max-width:320px}

.ftr{margin-top:16px;color:var(--muted);text-align:center}

/* Confetti */
.confetti{position:fixed;top:-10px;width:6px;height:10px;background:linear-gradient(#ffd166,#ef476f);opacity:.9;border-radius:2px;animation:drop 2.4s ease-in forwards;z-index:60}
@keyframes drop{to{transform:translateY(100vh) rotate(540deg);opacity:.2}}

/* Modal */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.45);display:flex;align-items:center;justify-content:center;z-index:80}
.modal{width:min(520px,94vw);background:var(--card);border:1px solid #d1d5db;border-radius:14px;padding:12px;box-shadow:0 20px 60px rgba(0,0,0,.35)}
.modal .mh{font-weight:800;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center}
.modal .row{gap:10px;margin:6px 0}
.modal label{font-size:13px;color:var(--muted)}
.modal input[type="text"], .modal input[type="number"], .modal select, .modal input[type="date"], .modal input[type="time"]{
  width:100%;padding:8px 10px;border-radius:10px;border:1px solid #d1d5db;background:var(--card);color:var(--text)
}
.modal .actions{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
.btn.danger{background:#b91c1c;color:#fff;border-color:#b91c1c}

/* Drag & drop */
.busyitem.dragging { opacity: .5; outline: 2px dashed var(--muted); }
.daycol.drag-target { outline: 2px dashed #64748b; outline-offset: 2px; }
.drop-indicator { position:absolute; left:6px; right:6px; height:2px; background:#60a5fa; pointer-events:none; }

/* Responsive */
@media (max-width: 1100px){
  .layout{grid-template-columns:1fr}
  .main .week{grid-template-columns:repeat(3,1fr)}
}
@media (max-width: 740px){
  .main .week{grid-template-columns:repeat(2,1fr)}
  .hdr-tools{gap:4px}
  .search{min-width:180px}
}
